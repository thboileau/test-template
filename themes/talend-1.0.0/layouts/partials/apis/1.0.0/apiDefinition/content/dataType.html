{{/*
	Copyright (C) 2010-2020 Talend Inc. - www.talend.com

	This source code is available under agreement available at
	https://github.com/Talend/api-portal-template/blob/main/LICENSE.md

	You should have received a copy of the agreement
	along with this program; if not, write to Talend SA
	9 rue Pages 92150 Suresnes, France
*/}}

{{ $itemsByJsonPath := .itemsByJsonPath -}}
{{ $idsByJsonPath := .idsByJsonPath -}}
{{ $apiDefinition := .apiDefinition -}}
{{ $dataType := .dataType -}}
{{ $id := .id -}}
{{ $randomId := delimit (shuffle (split (md5 "aria-controls for type") "" )) "" -}}

<section class="datatype" aria-labelledby="{{ $id }}">
	<div class="datatype__content">
		<div class="datatype__header">
			<h3 id="{{ $id }}">{{ $dataType.name -}}</h3>
		</div>
		<div class="definition__dataType definition">
			<div id="tooltip_{{ $id }}" class="js-tooltip-content" >
{{ with $dataType.description -}}<div class="dataType__description wysiwyg">{{ replace . "# " "#### " | markdownify -}}</div>{{ end -}}
{{ with cond (hasPrefix $dataType.type "#/components/") (index $itemsByJsonPath $dataType.type) $dataType -}}{{/* Solve potential referenced component */}}
	{{ partial "apis/1.0.0/apiDefinition/content/dataType_header" (dict "itemsByJsonPath" $itemsByJsonPath "idsByJsonPath" $idsByJsonPath "apiDefinition" $apiDefinition "dataType" . ) -}}
{{ end -}}

{{ with $dataType.examples -}}
	{{ $examplesAsList := partial "apis/1.0.0/functions/mapValuesToList" . -}}
	{{ $firstExample := index $examplesAsList 0 -}}
	{{ $exampleId := print $id "_" $randomId -}}
				<div class="definition-example">
					<div id="{{ $exampleId }}" class="definition-example__title">{{ $dataType.name -}}</div>
					<div role="region" tabindex="0" class="code-container" aria-labelledby="{{ $exampleId }}">
						<pre>
							<code>
{{ $firstExample.value -}}
							</code>
						</pre>
					</div>
				</div>
{{ end -}}
			</div>
		</div>
	</div>
</section>
