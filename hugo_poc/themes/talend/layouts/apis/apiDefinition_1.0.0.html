{{  $currentPage := . -}}
<!doctype html>
<html lang="en">
	<head>
{{ partial "head" . -}} 
	</head>
	<body class="api-reference">
		<header class="header">
{{ partial "header" . -}} 
		</header>

{{ with (index .Params "api-definition") -}}
	{{ $apiDefinition := . -}}

	{{/* generates the Rwadef used by the "Try-in-Tester" feature. */}}
	{{ $targetPath := (print "json/" $apiDefinition.Info.Name "-" $apiDefinition.Info.Version ".json") | urlize -}}
	{{ $rwadefResource := $apiDefinition | jsonify | resources.FromString $targetPath -}}

	{{ $itemsByJsonPath := partial "apis/functions/itemsByJsonPath" $apiDefinition -}}
	{{ $idsByJsonPath := dict -}}
	{{ with $apiDefinition.contract -}}
		{{ $idsByJsonPath = partial "apis/functions/idsByJsonPath" . -}}
	{{ end -}}
	{{ $apiVersionPages := where $.Site.RegularPages "Type" "eq" $currentPage.Type -}}
	{{ $siblingsApiDefinitionsPages := partial "apis/functions/siblingsApiDefinitionsPages" (dict "apiVersionPages" $apiVersionPages "currentApiName" $apiDefinition.Info.Name) -}} 
		<aside class="left-panel">
	{{ partial "apis/1.0.0/api-left-panel" (dict "siblingsApiDefinitionsPages" $siblingsApiDefinitionsPages "resources" $currentPage.Resources "itemsByJsonPath" $itemsByJsonPath "idsByJsonPath" $idsByJsonPath "apiDefinition" $apiDefinition "rwadefResource" $rwadefResource) -}}
		</aside>
		<main id="content">
    {{ partial "apis/1.0.0/api-content" (dict "currentPage" $currentPage "itemsByJsonPath" $itemsByJsonPath "idsByJsonPath" $idsByJsonPath "apiDefinition" $apiDefinition "rwadefResource" $rwadefResource) -}}
		</main>
{{ else -}}  {{/* The API has no "api-definition" YAML node */}}
		<main id="content">{{ i18n "content-not-expected" -}}</main>
{{ end -}} 
		<footer class="footer">
{{ partial "footer" . -}} 
		</footer>
		<script src="/js/main.js"></script>
	</body>
</html>
